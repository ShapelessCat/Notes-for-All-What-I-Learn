#+TITLE: Polars Cookbook
#+SUBTITLE: Over 60 practical recipes to transform, manipulate, and analyze your data using Python Polars 1.x
#+VERSION: 1st, 2024
#+AUTHOR: Yuki Kakegawa
#+STARTUP: entitiespretty
#+STARTUP: indent
#+STARTUP: overview

* Preface - xv
* 1 Getting Started with Python Polars - 1
** Technical requirements - 2
** Introducing key features in Polars - 3
*** Speed and efficiency - 3
*** Expressions - 4
*** The lazy API - 5
*** See also - 5

** The Polars DataFrame - 6
*** Getting ready - 6
*** How to do it... - 6
*** How it works... - 8
*** There’s more... - 9
*** See also - 10

** Polars Series - 10
*** Getting ready - 10
*** How to do it... - 11
*** How it works... - 13
*** There’s more... - 13
*** See also - 13

** The Polars LazyFrame - 13
- On the other hand, with /eager evaluation/ (another evaluation strategy you'd
  use with DataFrame), you process data every time per expression. Essentially,
  lazy evaluation gives you more efficient ways to process your data.

- You can access the Polars lazy API by using what we call LazyFrame. As
  explained earlier, LazyFrame allows for automatic query optimizations and
  larger-than-RAM processing.

- LazyFrame is the proffered way of using Polars simply because it has more
  features and abilities tohandle your data better. In this recipe, you’ll
  learn how to create a LazyFrame as well as how to useuseful methods and
  functions associated with LazyFrame.

*** How to do it... - 14
*** How it works... - 15
*** There’s more... - 16
*** See also - 19

** Selecting columns and filtering data - 19
*** Getting ready - 19
*** How to do it... - 19
*** How it works... - 21
*** There’s more... - 22
*** See also - 24

** Creating, modifying, and deleting columns - 24
*** Getting ready - 24
*** How to do it... - 25
*** How it works... - 28
*** There’s more... - 29
*** See also - 30

** Understanding method chaining - 30
*** Getting ready - 31
*** How to do it... - 31
*** How it works... - 32
*** There’s more... - 33
*** See also - 33

** Processing larger-than-RAM datasets - 33
*** How to do it... - 34
*** How it works... - 34
*** There’s more... - 35
*** See also - 36

* 2 Reading and Writing Files - 37
** Technical requirements - 37
** Reading and writing CSV files - 38
*** How to do it... - 38
*** How it works... - 41
*** There’s more... - 42
*** See also - 42

** Reading and writing Parquet files - 43
*** Getting ready - 43
*** How to do it... - 43
*** How it works... - 45
*** There’s more... - 45
*** See also - 47

** Reading and writing Delta Lake tables - 48
*** Getting ready - 48
*** How to do it... - 48
*** How it works... - 50
*** There’s more... - 51
*** See also - 52

** Reading and writing JSON files - 52
*** How to do it... - 52
*** How it works... - 53
*** There’s more... - 54
*** See also - 54

** Reading and writing Excel files - 55
*** Getting ready - 55
*** How to do it... - 55
*** How it works... - 56
*** See also - 56

** Reading and writing other data file formats - 57
*** Getting ready - 57
*** How to do it... - 57
*** How it works... - 58
*** There’s more... - 59
*** See also - 60

** Reading and writing multiple files - 60
*** How to do it... - 61
*** How it works... - 62
*** There’s more... - 62
*** See also - 63

** Working with databases - 63
*** Getting ready - 63
*** How to do it... - 64
*** How it works… - 65
*** See also - 66

* 3 An Introduction to Data Analysis in Python Polars - 67
** Technical requirements - 67
** Inspecting the DataFrame - 68
*** How to do it... - 68
*** How it works... - 70
*** There’s more... - 71
*** See also - 72

** Casting data types - 73
*** How to do it... - 73
*** How it works... - 74
*** There’s more... - 75
*** See also - 75

** Handling duplicate values - 76
*** How to do it... - 76
*** How it works... - 77
*** There’s more... - 78
*** See also - 78

** Masking sensitive data - 78
*** How to do it... - 79
*** How it works... - 80
*** There’s more... - 81
*** See also - 81

** Visualizing data using Plotly - 81
*** Getting ready - 81
*** How to do it... - 82
*** How it works... - 88
*** See also - 89

** Detecting and handling outliers - 89
*** Getting ready - 89
*** How to do it... - 90
*** How it works... - 94
*** There’s more... - 94
*** See also - 94

* 4 Data Transformation Techniques - 95
** Technical requirements - 96
** Exploring basic aggregations - 96
*** How to do it... - 96
*** How it works... - 98
*** There’s more... - 98
*** See also - 99

** Using group by aggregations - 100
*** Getting ready - 100
*** How to do it... - 100
*** How it works... - 103
*** There’s more... - 105
*** See also - 108

** Aggregating values across multiple columns - 108
*** Getting ready - 109
*** How to do it... - 109
*** How it works... - 111
*** There’s more... - 112
*** See also - 114

** Computing with window functions - 115
*** Getting ready - 115
*** How to do it... - 115
*** How it works... - 120
*** There’s more... - 121
*** See also - 123

** Applying UDFs - 123
*** Getting ready - 123
*** How to do it... - 124
*** How it works... - 125
*** There’s more... - 126
*** See also - 127

** Using SQL for data transformations - 127
*** Getting ready - 127
*** How to do it… - 127
*** How it works… - 130
*** See also - 130

* 5 Handling Missing Data - 131
** Technical requirements - 131
** Identifying missing data - 132
*** Getting ready - 132
*** How to do it... - 133
*** How it works... - 136
*** See also - 137

** Deleting rows and columns containing missing data - 137
*** Getting ready - 137
*** How to do it... - 138
*** How it works... - 140
*** There’s more... - 140
*** See also - 142

** Filling in missing data - 143
*** Getting ready - 143
*** How to do it... - 143
*** How it works... - 147
*** There’s more... - 147
*** See also - 147
* 6 Performing String Manipulations - 149
** Technical requirements - 149
** Filtering strings - 150
*** How to do it... - 150
*** How it works... - 153
*** There’s more... - 153
*** See also - 155

** Converting strings into date, time, and datetime - 155
*** How to do it... - 155
*** How it works... - 157
*** See also - 158

** Extracting substrings - 158
*** How to do it... - 158
*** How it works... - 162
*** There’s more... - 162
*** See also - 163

** Cleaning strings - 163
*** Getting ready - 164
*** How to do it... - 164
*** How it works... - 167
*** See also - 168

** Splitting strings into lists and structs - 168
*** Getting ready - 168
*** How to do it... - 168
*** How it works... - 170
*** See also - 170

** Concatenating and combining strings - 170
*** Getting ready - 170
*** How to do it... - 171
*** How it works... - 173
*** See also - 173

* 7 Working with Nested Data Structures - 175
** Technical requirements - 176
** Creating lists - 177
*** How to do it... - 177
*** How it works... - 179
*** There’s more... - 179
*** See also - 180

** Aggregating elements in lists - 181
*** How to do it... - 181
*** How it works... - 183
*** There’s more... - 183
*** See also - 184

** Accessing and selecting elements in lists - 184
*** Getting ready - 184
*** How to do it... - 185
*** How it works... - 188
*** There’s more... - 189
*** See also - 190

** Applying logic to each element in lists - 190
*** Getting ready - 191
*** How to do it... - 191
*** How it works... - 196
*** There’s more... - 197
*** See also - 198

** Working with structs and JSON data - 198
*** Getting ready - 199
*** How to do it... - 202
*** How to do it... - 207
*** There’s more… - 208
*** See also - 209

* 8 Reshaping and Tidying Data - 211
** Technical requirements - 211
** Turning columns into rows - 212
*** How to do it... - 213
*** How it works... - 215
*** See also - 215

** Turning rows into columns - 215
*** Getting ready - 216
*** How to do it... - 217
*** How it works... - 219
*** There’s more... - 220
*** See also - 223

** Joining DataFrames - 223
*** Getting ready - 223
*** How to do it... - 225
*** How it works... - 229
*** There’s more... - 231
*** See also - 231

** Concatenating DataFrames - 232
*** Getting ready - 232
*** How to do it... - 233
*** How it works... - 235
*** There’s more... - 235
*** See also - 236

** Other techniques for reshaping data - 236
*** Getting ready - 237
*** How to do it... - 237
*** How it works... - 238
*** See also - 238

* 9 Time Series Analysis - 239
** Technical requirements - 239
** Working with date and time - 242
*** How to do it... - 242
*** How it works... - 246
*** There is more... - 246
*** See also - 247

** Applying rolling window calculations - 247
*** How it works... - 253
*** There is more... - 254
*** See also - 256

** Resampling techniques - 256
*** How to do it... - 256
*** How it works... - 263
*** See also - 264

** Time series forecasting with the functime library - 264
*** Getting ready - 265
*** How to do it... - 267
*** How it works... - 271
*** There is more... - 271
*** See also - 272

* 10 Interoperability with Other Python Libraries - 273
** Technical requirements - 274
** Converting to and from a pandas DataFrame - 274
*** Getting ready - 274
*** How to do it... - 274
*** How it works... - 275
*** There’s more... - 276
*** See also - 276

** Converting to and from NumPy arrays - 276
*** Getting ready - 277
*** How to do it... - 277
*** How it works... - 278
*** There’s more... - 278
*** See also - 279

** Interoperating with PyArrow - 279
*** Getting ready - 279
*** How to do it... - 280
*** How it works... - 283
*** See also - 283

** Integrating with DuckDB - 283
*** Getting ready - 284
*** How to do it... - 284
*** How it works... - 285
*** See also - 285

* 11 Working with Common Cloud Data Sources - 287
** Technical requirements - 288
** Working with Amazon S3 - 289
*** Getting ready - 289
*** How to do it... - 298
*** How it works... - 300
*** See also - 301

** Working with Azure Blob Storage - 301
*** Getting ready - 301
*** How to do it... - 310
*** How it works... - 313
*** There’s more... - 313
*** See also - 313

** Working with Google Cloud Storage - 313
*** Getting ready - 314
*** How to do it... - 318
*** How it works... - 321
*** See also - 321

** Working with BigQuery - 321
*** Getting ready - 322
*** How to do it... - 326
*** How it works... - 328
*** See also - 329

** Working with Snowflake - 329
*** Getting ready - 329
*** How to do it... - 332
*** How it works... - 335
*** See also - 336

* 12 Testing and Debugging in Polars 337
** Technical requirements - 337
** Debugging chained operations - 338
*** How to do it... - 338
*** How it works... - 343
*** There’s more... - 344
*** See also - 345

** Inspecting and optimizing the query plan - 345
*** Getting ready - 345
*** How to do it... - 346
*** How it works... - 349
*** There’s more... - 349
*** See also - 350

** Testing data quality with cuallee - 350
*** Getting ready - 351
*** How to do it... - 351
*** How it works... - 354
*** There’s more... - 354
*** See also - 354

** Running unit tests with pytest - 355
*** Getting ready - 355
*** How to do it... - 355
*** How it works... - 359
*** There’s more... - 359
*** See also - 360

* Index - 361
* Other Books You May Enjoy - 368
